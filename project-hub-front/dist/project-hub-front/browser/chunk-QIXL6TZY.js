import{a as oe,b as ne,c as le,d as de,e as ue,f as ge,g as fe,h as Ce}from"./chunk-7M4RS7ZH.js";import{a as ee,b as te,d as ie}from"./chunk-HKIRSCHN.js";import{a as Te}from"./chunk-5XAABUMC.js";import{c as re,d as je,e as ae,f as se,g as me,h as pe,i as Ve,j as Ie,k as ce}from"./chunk-4NGDR7O5.js";import{d as O,e as X,f as Y,g as Z,h as $,i as ye,j as Ee}from"./chunk-T7MGDWGT.js";import{c as _e}from"./chunk-Y66WSUQK.js";import{Ja as G,Ka as K,P as U,Pa as z,Qa as J,T as R,a as Re,ea as B,ga as L,ja as A,pa as H,qa as q,ua as Q}from"./chunk-NB76KGKE.js";import{$ as m,Ab as _,Cb as f,Db as s,Jb as I,Kb as k,Lb as P,Lc as N,Ma as c,O as Me,Ob as F,Pb as d,Qb as M,Ra as E,Tb as S,U as y,Ub as b,Vb as v,Wb as W,Xb as w,Ya as D,aa as p,cb as C,hc as u,k as ve,kb as h,na as Se,nb as T,pb as j,pc as Ue,ub as n,vb as r,wb as g,z as we}from"./chunk-U6KPTH7L.js";import{a as be}from"./chunk-GAL4ENT6.js";var V=class o{http=y(Re);apiUrl=Ee.apiUrl;selectedRole=Se(null);selectedRoles=Se([]);allRoles=Ue(()=>this.getAllRolesResource?.value()||[]);getAllRolesResource=ye({loader:()=>this.http.get(this.apiUrl+"projectrole").pipe(we(()=>ve([])))});createRole(t){this.http.post(this.apiUrl+"projectrole",t).subscribe(()=>{this.getAllRolesResource.reload(),console.log(t,"created")})}editRole(t,e){this.http.put(this.apiUrl+"projectrole/"+t,e).subscribe(()=>{this.getAllRolesResource.reload(),console.log(e,"updated")})}deleteRole(t){this.http.delete(this.apiUrl+"projectrole/"+t).subscribe(()=>{this.getAllRolesResource.reload(),console.log(t,"deleted")})}static \u0275fac=function(e){return new(e||o)};static \u0275prov=Me({token:o,factory:o.\u0275fac,providedIn:"root"})};var Oe=["dt"],ze=["ph"],Je=()=>({width:"450px",height:"600px"}),Xe=()=>({width:"450px"}),Ye=()=>({"min-width":"75rem"}),Ze=()=>[10,20,30];function $e(o,t){if(o&1){let e=_();n(0,"p-button",12),f("onClick",function(){m(e);let i=s(2);return p(i.openNew())}),r()}}function et(o,t){}function tt(o,t){o&1&&(n(0,"div",8)(1,"p-toolbar",10),C(2,$e,1,0,"ng-template",null,2,u)(4,et,0,0,"ng-template",null,3,u),r(),n(6,"span",11),d(7,"No users found"),r()())}function it(o,t){o&1&&(n(0,"div",8),g(1,"p-skeleton",13),r())}function ot(o,t){if(o&1){let e=_();n(0,"p-button",12),f("onClick",function(){m(e);let i=s(3);return p(i.openNew())}),r()}}function nt(o,t){if(o&1){let e=_();n(0,"p-button",15),f("onClick",function(){m(e);let i=s(3);return p(i.exportCSV())}),r()}}function rt(o,t){if(o&1){let e=_();n(0,"div",16)(1,"h5",17),d(2,"Manage Users"),r(),n(3,"p-iconfield"),g(4,"p-inputicon",18),n(5,"input",19),f("input",function(i){m(e),s();let a=F(7),x=s(2);return p(x.onGlobalFilter(a,i))}),r()()()}}function lt(o,t){o&1&&(n(0,"tr")(1,"th",20)(2,"span",21),d(3,"ID "),g(4,"p-sortIcon",22),r()(),n(5,"th",23)(6,"span",21),d(7,"Name "),g(8,"p-sortIcon",24),r()(),n(9,"th",25)(10,"span",21),d(11,"Email "),g(12,"p-sortIcon",26),r()(),n(13,"th",27)(14,"span",21),d(15,"Phone "),g(16,"p-sortIcon",28),r()(),n(17,"th",29)(18,"span",21),d(19,"Role "),g(20,"p-sortIcon",30),r()(),g(21,"th",31),r())}function at(o,t){if(o&1){let e=_();n(0,"tr")(1,"td"),d(2),r(),n(3,"td"),d(4),r(),n(5,"td"),d(6),r(),n(7,"td"),d(8),r(),n(9,"td"),d(10),r(),n(11,"td")(12,"p-button",32),f("click",function(){let i=m(e).$implicit,a=s(3);return p(a.editUser(i))}),r(),n(13,"p-button",33),f("click",function(){let i=m(e).$implicit,a=s(3);return p(a.deleteSelectedUsers(i.id))}),r()()()}if(o&2){let e=t.$implicit;c(2),M(e.id),c(2),M(e.name),c(2),M(e.email),c(2),M(e.phone),c(2),M(e.role==null?null:e.role.name),c(2),h("rounded",!0)("outlined",!0),c(),h("rounded",!0)("outlined",!0)}}function st(o,t){if(o&1){let e=_();n(0,"div",8)(1,"p-toolbar",10),C(2,ot,1,0,"ng-template",null,2,u)(4,nt,1,0,"ng-template",null,3,u),r(),n(6,"p-table",14,4),v("selectionChange",function(i){m(e);let a=s(2);return b(a.projectUserService.selectedUsers,i)||(a.projectUserService.selectedUsers=i),p(i)}),C(8,rt,6,0,"ng-template",null,5,u)(10,lt,22,0,"ng-template",null,6,u)(12,at,14,9,"ng-template",null,7,u),r()()}if(o&2){let e=s(2);c(6),h("value",e.projectUserService.allUsers())("rows",10)("columns",e.cols)("paginator",!0)("globalFilterFields",e.filterColFields)("tableStyle",w(10,Ye)),S("selection",e.projectUserService.selectedUsers),h("rowHover",!0)("showCurrentPageReport",!0)("rowsPerPageOptions",w(11,Ze))}}function mt(o,t){if(o&1&&C(0,it,2,0,"div",8)(1,st,14,12,"div",8),o&2){let e=s();j(e.projectUserService.getAllUsersResource.isLoading()==!0?0:1)}}function pt(o,t){if(o&1){let e=_();n(0,"div",34)(1,"div",35)(2,"label",36),d(3,"Name"),r(),n(4,"input",37),v("ngModelChange",function(i){m(e);let a=s();return b(a.projectUser.name,i)||(a.projectUser.name=i),p(i)}),r()(),n(5,"div",35)(6,"label",38),d(7,"Email"),r(),n(8,"input",39),v("ngModelChange",function(i){m(e);let a=s();return b(a.projectUser.email,i)||(a.projectUser.email=i),p(i)}),r()(),n(9,"div",35)(10,"label",40),d(11,"Phone"),r(),n(12,"input",41),v("ngModelChange",function(i){m(e);let a=s();return b(a.projectUser.phone,i)||(a.projectUser.phone=i),p(i)}),r()(),n(13,"div",35)(14,"label",42),d(15,"Role"),r(),n(16,"p-select",43),v("ngModelChange",function(i){m(e);let a=s();return b(a.projectUser.roleId,i)||(a.projectUser.roleId=i),p(i)}),r()()()}if(o&2){let e=s();c(4),S("ngModel",e.projectUser.name),c(4),S("ngModel",e.projectUser.email),c(4),S("ngModel",e.projectUser.phone),c(4),h("options",e.roleService.allRoles()),S("ngModel",e.projectUser.roleId)}}function ct(o,t){if(o&1){let e=_();n(0,"p-button",44),f("click",function(){m(e);let i=s();return p(i.hideDialog())}),r(),n(1,"p-button",45),f("click",function(){m(e);let i=s();return p(i.saveUser())}),r()}}var he=class o{constructor(t,e){this.messageService=t;this.confirmationService=e}projectUserService=y(Te);roleService=y(V);filterColFields=["id","name","email","phone","role"];projectUserDialog=!1;projectUser;projectUsers;projectUserSubmitted=!1;dt;ph;exportColumns;cols;exportCSV(){this.dt.exportCSV()}onGlobalFilter(t,e){t.filterGlobal(e.target.value,"contains")}openNew(){this.projectUser={id:"",name:"",email:"",phone:"",roleId:0,role:{id:0,name:""}},this.projectUserSubmitted=!1,this.projectUserDialog=!0}editUser(t){this.projectUser={id:t.id,name:t.name,email:t.email,phone:t.phone,roleId:t.role?.id||t.roleId||0,role:t.role||{id:0,name:""}},console.log("Editing user with ID:",t.id,"Role ID:",this.projectUser.roleId),this.projectUserService.selectedUser.set(t),this.projectUserDialog=!0}deleteSelectedUsers(t){this.confirmationService.confirm({message:"Are you sure you want to delete the selected Users?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this.projectUserService.selectedUsers.set(this.projectUserService.selectedUsers().filter(e=>!this.projectUserService.selectedUsers().includes(e))),this.projectUserService.deleteUser(t),this.messageService.add({severity:"success",summary:"Successful",detail:"Users Deleted",life:3e3})}})}hideDialog(){this.projectUserDialog=!1,this.projectUserSubmitted=!1}findUserIndexById(t){let e=-1;for(let l=0;l<this.projectUserService.allUsers().length;l++)if(this.projectUserService.allUsers()[l].id===t){e=l;break}return e}createId(){let t="";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",l=0;l<5;l++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}createUserId(t){this.projectUserService.createUser(t)}saveUser(){this.projectUserSubmitted=!0;let t=this.projectUserService.allUsers();if(this.projectUser.name?.trim()){if(this.projectUser.id){console.log("Updating user with ID:",this.projectUser.id);let e={id:this.projectUser.id,name:this.projectUser.name,email:this.projectUser.email,phone:this.projectUser.phone,roleId:this.projectUser.roleId};t[this.findUserIndexById(this.projectUser.id)]=this.projectUser,this.projectUserService.selectedUsers.set([...t]),this.projectUserService.editUser(this.projectUser.id,e),this.messageService.add({severity:"success",summary:"Successful",detail:"User Updated",life:3e3})}else{console.log("Creating new user");let e={id:this.projectUser.id,name:this.projectUser.name,email:this.projectUser.email,phone:this.projectUser.phone,roleId:this.projectUser.roleId};this.messageService.add({severity:"success",summary:"Successful",detail:"User Created",life:3e3}),this.projectUserService.createUser(e)}this.projectUserDialog=!1,this.projectUser={id:"",name:"",email:"",phone:"",roleId:0,role:{id:0,name:""}}}}static \u0275fac=function(e){return new(e||o)(E(R),E(U))};static \u0275cmp=D({type:o,selectors:[["app-manage-users"]],viewQuery:function(e,l){if(e&1&&(I(Oe,5),I(ze,5)),e&2){let i;k(i=P())&&(l.dt=i.first),k(i=P())&&(l.ph=i.first)}},features:[W([R,U])],decls:8,vars:9,consts:[["content",""],["footer",""],["start",""],["end",""],["ph",""],["caption",""],["header",""],["body",""],[1,"card"],["header","Resource Details",3,"visibleChange","visible","modal"],["styleClass","mb-12"],[1,"text-center","text-lg","text-orange-500"],["label","New","icon","pi pi-plus","severity","secondary",1,"mr-2",3,"onClick"],["width","full","height","10rem"],["dataKey","id","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} users",3,"selectionChange","value","rows","columns","paginator","globalFilterFields","tableStyle","selection","rowHover","showCurrentPageReport","rowsPerPageOptions"],["label","Export","icon","pi pi-upload","severity","secondary",3,"onClick"],[1,"flex","items-center","justify-between"],[1,"m-0"],["styleClass","pi pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],["pSortableColumn","id",2,"min-width","3rem"],[1,"flex","items-center","gap-2"],["field","id"],["pSortableColumn","name",2,"min-width","16rem"],["field","name"],["pSortableColumn","email",2,"min-width","16rem"],["field","email"],["pSortableColumn","phone",2,"min-width","16rem"],["field","phone"],["pSortableColumn","role",2,"min-width","16rem"],["field","role"],[2,"min-width","12rem"],["icon","pi pi-pencil",1,"mr-2",3,"click","rounded","outlined"],["icon","pi pi-trash","severity","danger",3,"click","rounded","outlined"],[1,"grid","grid-cols-12","gap-4"],[1,"col-span-12"],["for","name",1,"block","font-bold","mb-4"],["type","text","pInputText","","id","name","required","",3,"ngModelChange","ngModel"],["for","email",1,"block","font-bold","mb-4"],["type","text","pInputText","","id","email","required","",3,"ngModelChange","ngModel"],["for","phone",1,"block","font-bold","mb-4"],["type","text","pInputText","","id","phone","required","",3,"ngModelChange","ngModel"],["for","role",1,"block","font-bold","mb-4"],["optionLabel","name","optionValue","id","required","",3,"ngModelChange","options","ngModel"],["label","Cancel","icon","pi pi-times","text","",3,"click"],["label","Save","icon","pi pi-check",3,"click"]],template:function(e,l){if(e&1){let i=_();C(0,tt,8,0,"div",8)(1,mt,2,1),n(2,"p-dialog",9),v("visibleChange",function(x){return m(i),b(l.projectUserDialog,x)||(l.projectUserDialog=x),p(x)}),C(3,pt,17,5,"ng-template",null,0,u)(5,ct,2,0,"ng-template",null,1,u),r(),g(7,"p-confirmdialog")}e&2&&(j(l.projectUserService.allUsers().length==0?0:1),c(2),T(w(7,Je)),S("visible",l.projectUserDialog),h("modal",!0),c(5),T(w(8,Xe)))},dependencies:[N,ce,se,me,pe,q,B,L,H,A,K,G,Q,ie,ge,ue,le,J,z,_e,ae,je,O,re,te,ee,de,$,Z,Y,X,ne,oe,Ce,fe],encapsulation:2})};var dt=["ph"],Pe=()=>({width:"450px"}),_t=()=>({"min-width":"75rem"}),ut=()=>[10,20,30];function gt(o,t){if(o&1){let e=_();n(0,"p-button",12),f("onClick",function(){m(e);let i=s(2);return p(i.openNew())}),r()}}function ft(o,t){}function Ct(o,t){o&1&&(n(0,"div",8)(1,"p-toolbar",10),C(2,gt,1,0,"ng-template",null,2,u)(4,ft,0,0,"ng-template",null,3,u),r(),n(6,"span",11),d(7,"No roles found"),r()())}function ht(o,t){o&1&&(n(0,"div",8),g(1,"p-skeleton",13),r())}function xt(o,t){if(o&1){let e=_();n(0,"p-button",12),f("onClick",function(){m(e);let i=s(3);return p(i.openNew())}),r()}}function St(o,t){if(o&1){let e=_();n(0,"p-button",15),f("onClick",function(){m(e);let i=s(3);return p(i.exportCSV())}),r()}}function bt(o,t){if(o&1){let e=_();n(0,"div",16)(1,"h5",17),d(2,"Manage Roles"),r(),n(3,"p-iconfield"),g(4,"p-inputicon",18),n(5,"input",19),f("input",function(i){m(e),s();let a=F(7),x=s(2);return p(x.onGlobalFilter(a,i))}),r()()()}}function vt(o,t){o&1&&(n(0,"tr")(1,"th",20),g(2,"p-tableHeaderCheckbox"),r(),n(3,"th",21)(4,"span",22),d(5,"ID "),g(6,"p-sortIcon",23),r()(),n(7,"th",24)(8,"span",22),d(9,"Name "),g(10,"p-sortIcon",25),r()(),g(11,"th",26),r())}function wt(o,t){if(o&1){let e=_();n(0,"tr")(1,"td"),g(2,"p-tableCheckbox",27),r(),n(3,"td"),d(4),r(),n(5,"td"),d(6),r(),n(7,"td")(8,"p-button",28),f("click",function(){let i=m(e).$implicit,a=s(3);return p(a.editRole(i))}),r(),n(9,"p-button",29),f("click",function(){let i=m(e).$implicit,a=s(3);return p(a.deleteSelectedRoles(i.id))}),r()()()}if(o&2){let e=t.$implicit;c(2),h("value",e),c(2),M(e.id),c(2),M(e.name),c(2),h("rounded",!0)("outlined",!0),c(),h("rounded",!0)("outlined",!0)}}function Mt(o,t){if(o&1){let e=_();n(0,"div",8)(1,"p-toolbar",10),C(2,xt,1,0,"ng-template",null,2,u)(4,St,1,0,"ng-template",null,3,u),r(),n(6,"p-table",14,4),v("selectionChange",function(i){m(e);let a=s(2);return b(a.roleService.selectedRoles,i)||(a.roleService.selectedRoles=i),p(i)}),C(8,bt,6,0,"ng-template",null,5,u)(10,vt,12,0,"ng-template",null,6,u)(12,wt,10,7,"ng-template",null,7,u),r()()}if(o&2){let e=s(2);c(6),h("value",e.roleService.allRoles())("rows",10)("columns",e.cols)("paginator",!0)("globalFilterFields",e.filterColFields)("tableStyle",w(10,_t)),S("selection",e.roleService.selectedRoles),h("rowHover",!0)("showCurrentPageReport",!0)("rowsPerPageOptions",w(11,ut))}}function Ut(o,t){if(o&1&&C(0,ht,2,0,"div",8)(1,Mt,14,12,"div",8),o&2){let e=s();j(e.roleService.getAllRolesResource.isLoading()==!0?0:1)}}function Rt(o,t){if(o&1){let e=_();n(0,"div",30)(1,"div",31)(2,"label",32),d(3,"Name"),r(),n(4,"input",33),v("ngModelChange",function(i){m(e);let a=s();return b(a.role.name,i)||(a.role.name=i),p(i)}),r()()()}if(o&2){let e=s();c(4),S("ngModel",e.role.name)}}function yt(o,t){if(o&1){let e=_();n(0,"p-button",34),f("click",function(){m(e);let i=s();return p(i.hideDialog())}),r(),n(1,"p-button",35),f("click",function(){m(e);let i=s();return p(i.saveRole())}),r()}}var xe=class o{constructor(t,e){this.messageService=t;this.confirmationService=e}roleService=y(V);filterColFields=["id","name"];roleDialog=!1;role;roleSubmitted=!1;ph;exportColumns;cols;exportCSV(){this.ph.exportCSV()}onGlobalFilter(t,e){t.filterGlobal(e.target.value,"contains")}openNew(){this.role={id:0,name:""},this.roleSubmitted=!1,this.roleDialog=!0}editRole(t){this.role=be({},t),this.roleService.selectedRole.set(t),this.roleDialog=!0}deleteSelectedRoles(t){this.confirmationService.confirm({message:"Are you sure you want to delete the selected categories?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this.roleService.selectedRoles.set(this.roleService.selectedRoles().filter(e=>!this.roleService.selectedRoles().includes(e))),this.roleService.deleteRole(t),this.messageService.add({severity:"success",summary:"Successful",detail:"Roles Deleted",life:3e3})}})}hideDialog(){this.roleDialog=!1,this.roleSubmitted=!1}findRoleIndexById(t){let e=-1;for(let l=0;l<this.roleService.allRoles().length;l++)if(this.roleService.allRoles()[l].id===t){e=l;break}return e}createRoleId(t){this.roleService.createRole(t)}saveRole(){this.roleSubmitted=!0;let t=this.roleService.allRoles();this.role.name?.trim()&&(this.role.id?(console.log(this.role),t[this.findRoleIndexById(this.role.id)]=this.role,this.roleService.selectedRoles.set([...t]),this.roleService.editRole(this.role.id,this.role),this.messageService.add({severity:"success",summary:"Successful",detail:"Role Updated",life:3e3})):(this.messageService.add({severity:"success",summary:"Successful",detail:"Role Created",life:3e3}),this.roleService.createRole(this.role)),this.roleDialog=!1,this.role={id:0,name:""})}static \u0275fac=function(e){return new(e||o)(E(R),E(U))};static \u0275cmp=D({type:o,selectors:[["app-manage-roles"]],viewQuery:function(e,l){if(e&1&&I(dt,5),e&2){let i;k(i=P())&&(l.ph=i.first)}},features:[W([R,U])],decls:8,vars:9,consts:[["content",""],["footer",""],["start",""],["end",""],["ph",""],["caption",""],["header",""],["body",""],[1,"card"],["header","Role Details",3,"visibleChange","visible","modal"],["styleClass","mb-12"],[1,"text-center","text-lg","text-orange-500"],["label","New","icon","pi pi-plus","severity","secondary",1,"mr-2",3,"onClick"],["width","full","height","10rem"],["dataKey","id","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} roles",3,"selectionChange","value","rows","columns","paginator","globalFilterFields","tableStyle","selection","rowHover","showCurrentPageReport","rowsPerPageOptions"],["label","Export","icon","pi pi-upload","severity","secondary",3,"onClick"],[1,"flex","items-center","justify-between"],[1,"m-0"],["styleClass","pi pi-search"],["pInputText","","type","text","placeholder","Search...",3,"input"],[2,"width","3rem"],["pSortableColumn","id",2,"min-width","3rem"],[1,"flex","items-center","gap-2"],["field","id"],["pSortableColumn","name",2,"min-width","16rem"],["field","name"],[2,"min-width","12rem"],[3,"value"],["icon","pi pi-pencil",1,"mr-2",3,"click","rounded","outlined"],["icon","pi pi-trash","severity","danger",3,"click","rounded","outlined"],[1,"grid","grid-cols-12","gap-4"],[1,"col-span-12"],["for","name",1,"block","font-bold","mb-4"],["type","text","pInputText","","id","name","required","",3,"ngModelChange","ngModel"],["label","Cancel","icon","pi pi-times","text","",3,"click"],["label","Save","icon","pi pi-check",3,"click"]],template:function(e,l){if(e&1){let i=_();C(0,Ct,8,0,"div",8)(1,Ut,2,1),n(2,"p-dialog",9),v("visibleChange",function(x){return m(i),b(l.roleDialog,x)||(l.roleDialog=x),p(x)}),C(3,Rt,5,1,"ng-template",null,0,u)(5,yt,2,0,"ng-template",null,1,u),r(),g(7,"p-confirmdialog")}e&2&&(j(l.roleService.allRoles().length==0?0:1),c(2),T(w(7,Pe)),S("visible",l.roleDialog),h("modal",!0),c(5),T(w(8,Pe)))},dependencies:[ce,se,me,pe,Ve,Ie,N,q,B,L,H,A,K,G,Q,ie,ge,ue,le,J,z,_e,ae,O,re,te,ee,de,$,Z,Y,X,ne,oe,Ce,fe],encapsulation:2})};var Fi=[{path:"manage",component:he,data:{breadcrumb:"Manage Users"}},{path:"roles/manage",component:xe,data:{breadcrumb:"Manage Roles"}}];export{Fi as default};
